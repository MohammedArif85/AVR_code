/*
===================================================================
SET DESIRED BAUD RATE
===================================================================
*/

#define BAUDRATE 9600
/*
===================================================================
CALCULATE UBRR VALUE
===================================================================
*/
#define UBRRVAL ((F_CPU/(BAUDRATE*16UL))-1)

void USART_INIT()
{
/*
===================================================================
SET BAUD RATE
===================================================================
*/
	UBRRL=UBRRVAL;
	UBRRH=(UBRRVAL>>8);

/*===================================================================
SET DATAFRAME FORMAT : ASYNCHRONOUS MODE, NO PARITY, 1 START BIT, 8BIT
                       SIZE DATA	
===================================================================
*/
	UCSRC=0x86;
/*
===================================================================
ENABLE TRANSMITTER AND RECEIVER	
===================================================================
*/
	//UCSRB=(1<<RXEN)|(1<<TXEN);
	
		//Enable Transmitter and Receiver and Interrupt on receive complete

	UCSRB=0x98;

	//enable global interrupts

	set_sleep_mode(SLEEP_MODE_IDLE);
	sei();

	
}

/*
===================================================================
FUNCTION TO WRITE CHARACTER
===================================================================
*/
void rswritechar(unsigned char c)
{
/*
===================================================================
WAIT FOR EMPTY TRANSMIT BUFFER
===================================================================
*/
	while(!(UCSRA&(1<<UDRE)));
	UDR=c; //SEND RECEIVED DATA BACK
}

/*
===================================================================
FUNCTION TO READ CHARACTER
===================================================================
*/

unsigned char rsreadchar(void)
{
/*
===================================================================
WAIT UNTIL DATA IS AVAILABLE
===================================================================
*/
	while(!(UCSRA&(1<<RXC)))
	{	}
	return UDR;
}

/*
===================================================================
FUNCTION TO PRINT STRING
===================================================================
*/
void rsstr(char *s)
{
	while(*s)
	{
		rswritechar(*s);
		s++;
	}
}


